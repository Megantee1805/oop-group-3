{% extends 'base.html' %}

{% block title %}Food Journal{% endblock %}

{% block content %}

<div id="colorlib-container">
    <div class="container">
        <div class="box1">
        <div class="row row-pb-md">
            <div class="col-md-12">

                <form method="post">
                    <header id="summary-header">
                        <h1 class="font_color">Add Food Code</h1>
                    </header>

                    <input name="code" id="code" class="form-control" value="{{ request.form['code'] }}" placeholder="Food Code (eg: a00001)" required>
                    <div class="row form-group" id="register-button">
                        <input type="submit" value="Save Food" class="btn btn-primary" style="background-color: #4CAF50;">
                    </div>

                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                <div class="row form-group">
                                    <div class="col-md-12">
                                        <div class="flash {{ category }}">{{ message }}</div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}
                </form>

            </div>
        </div>
        </div>

        <div class="box1">
        <div class="row row-pb-md">
            <div class="col-md-12">

                <header>
                    <h1 class="font_color">Food History</h1>
                </header>

                {% if food_exists == 0 %}
                    <article class="food-journal">
                        <header>
                            <div class="food-subsection">
                                <h4 style="margin-bottom: 0"><b>No food added to list</b></h4>
                            </div>
                        </header>
                    </article>

                {% else %}
                {% for date in food_dates %}

                    {% set example_food = date[0] %}
                    {% set example_date = example_food['created'].strftime('%d %B (%A)') %}
                    <h2> <b>{{ example_date }}</b> </h2>

                    {% for food in date %}

                        <article class="food-journal">
                            <header>
                                <div class="food-subsection">
                                    <div id="time-created"> <i>{{ food['created'].strftime('%I:%M %p') }}</i> </div>
                                    <h4 style="margin-bottom: 0"><b>{{ food['food_name'] }}</b></h4>
                                    <div class="about"> {{ food['calories'] }} calories <br> Code: <b> {{ food['food_code'] }} </b>
                                    <br>
                                    <span id="user-profile"><a class="action" href="{{ url_for('food.edit_food', id = food['id']) }}"><i>Edit</i></a></span>
                                    </div>
                                </div>
                            </header>
                        </article>

                    {% if not loop.last %}
                    {% endif %}
                    {% endfor %}

                    <h5>Total calories consumed: <b> {{ calories_list[loop.index - 1] }} kcal </b> </h5>

                    <hr>

                {% if not loop.last %}
                {% endif %}
                {% endfor %}

                {% endif %}

            </div>
            </div>
        </div>
        </div>
    </div>

{% endblock %}
